<html>
    <!-- Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php -->
    <head>

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.js"></script>

    <script type="text/javascript" src="sites/_BaseSite.js"></script>
    <script type="text/javascript" src="sites/_sites.js"></script>

    <script type="text/javascript">
    var pollInterval = 1000 * 60 * 60 * 1;
    google.load("feeds", "1");
	google.setOnLoadCallback(pageLoaded);

    function pageLoaded()
    {
        loadSites();
        updateSites();
    }

    function updateSites()
    {
        for(var i = 0; i < window.sites.length; i++)
        {
            window.sites[i].updateInfo(onUpdateDone);
        }
        setTimeout(updateSites, pollInterval);
    }

    function onUpdateDone(isRead)
    {
        if(isRead == "false")
        {
            chrome.browserAction.setBadgeBackgroundColor({color:[214,1,2,255]});
            chrome.browserAction.setBadgeText({text:"!"});
        }
    }
    </script>
    </head>
    <body></body>
</html>